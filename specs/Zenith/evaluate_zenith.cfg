CONSTANTS
s0 = s0
s1 = s1
CONSTANTS
t0 = t0

\* Model values for labeling things
CONSTANTS
    Failed = Failed
    NotFailed = NotFailed
    CONT_SEQ = CONT_SEQ
    IR_RECONCILE = IR_RECONCILE
    NO_TAG = NO_TAG
    OFA_DOWN = OFA_DOWN
    SW_RESOLVE_PROC = SW_RESOLVE_PROC
    NIC_ASIC_IN = NIC_ASIC_IN
    NO_LOCK = NO_LOCK
    INSTALL_FLOW = INSTALL_FLOW
    KEEP_ALIVE = KEEP_ALIVE
    ofc0 = ofc0
    IR_NONE = IR_NONE
    SW_FAILURE_PROC = SW_FAILURE_PROC
    IR_UNLOCK = IR_UNLOCK
    SW_SUSPEND = SW_SUSPEND
    STATUS_NONE = STATUS_NONE
    STATUS_LOCKING = STATUS_LOCKING
    GHOST_UNLOCK_PROC = GHOST_UNLOCK_PROC
    INSTALLER = INSTALLER
    SW_SIMPLE_ID = SW_SIMPLE_ID
    START_RESET_IR = START_RESET_IR
    SW_UP = SW_UP
    OFA_IN = OFA_IN
    IR_PENDING = IR_PENDING
    INSTALLER_UP = INSTALLER_UP
    INSTALLER_DOWN = INSTALLER_DOWN
    RECEIVED_SUCCESSFULLY = RECEIVED_SUCCESSFULLY
    SW_SIMPLE_MODEL = SW_SIMPLE_MODEL
    CONT_MONITOR = CONT_MONITOR
    CONT_EVENT = CONT_EVENT
    SW_RUN = SW_RUN
    STATUS_SENT_DONE = STATUS_SENT_DONE
    SW_DOWN = SW_DOWN
    IR_DONE = IR_DONE
    SW_COMPLEX_MODEL = SW_COMPLEX_MODEL
    STATUS_START_SCHEDULING = STATUS_START_SCHEDULING
    NIC_ASIC_DOWN = NIC_ASIC_DOWN
    rc0 = rc0
    NO_STATUS = NO_STATUS
    OFA_OUT = OFA_OUT
    IR_SENT = IR_SENT
    NIC_ASIC_OUT = NIC_ASIC_OUT
    INSTALLED_SUCCESSFULLY = INSTALLED_SUCCESSFULLY
    DELETE_FLOW = DELETE_FLOW
    DELETED_SUCCESSFULLY = DELETED_SUCCESSFULLY
    IR_MOD = IR_MOD
    TOPO_MOD = TOPO_MOD
    DAG_STALE = DAG_STALE
    CONT_WORKER_SEQ = CONT_WORKER_SEQ
    DAG_UNLOCK = DAG_UNLOCK
    DAG_NONE = DAG_NONE
    DAG_SUBMIT = DAG_SUBMIT
    SEQ_WORKER_STALE_REMOVED = SEQ_WORKER_STALE_REMOVED
    DAG_NEW = DAG_NEW
    CONT_TE = CONT_TE
    NIB_EVENT_HANDLER = NIB_EVENT_HANDLER
    CONT_BOSS_SEQ = CONT_BOSS_SEQ
    IR_FAILED = IR_FAILED
    CLEAR_TCAM = CLEAR_TCAM
    CLEARED_TCAM_SUCCESSFULLY = CLEARED_TCAM_SUCCESSFULLY

\* These NIB constants have no effect in this scenario
CONSTANTS 
    SW_RECONCILE = SW_RECONCILE
    RECONCILIATION_REQUEST = RECONCILIATION_REQUEST
    RECONCILIATION_RESPONSE = RECONCILIATION_RESPONSE
    ALL_FLOW = ALL_FLOW
    FLOW_STAT_REQ = FLOW_STAT_REQ
    FLOW_STAT_REPLY = FLOW_STAT_REPLY
    NO_ENTRY = NO_ENTRY
    ENTRY_FOUND = ENTRY_FOUND

\* For Nadir
CONSTANTS
    NADIR_NULL = NADIR_NULL

\* Inputs
CONSTANTS
    \* Set of all switches to consider
    SW <- const_SW
    \* Maximum number of installable network OPs
    MaxNumIRs <- const_MaxNumIRs
    \* Maximum number of DAGs to consider
    MaxDAGID <- const_MaxDAGID
    \* Set of thread identifiers for WP
    CONTROLLER_THREAD_POOL <- const_CONTROLLER_THREAD_POOL
    \* In which order and how should switches fail
    SW_FAIL_ORDERING <- const_SW_FAIL_ORDERING
    \* Mapping from switch IDs to Simple/Complex model identifier
    WHICH_SWITCH_MODEL <- const_WHICH_SWITCH_MODEL
    \* The final DAG that we expect to see in the network once all failures have passed
    \* and the controller has declared convergence
    FINAL_DAG <- const_FINAL_DAG
    \* Mapping from installable network OPs to their destination switch ID
    IR2SW <- const_IR2SW
    \* Mapping from set of down switches, to the DAG to install
    TOPO_DAG_MAPPING <- const_TOPO_DAG_MAPPING
    \* Maximum number of submodule failures to consider
    MAX_OFC_SUBMODULE_FAILS <- const_MAX_OFC_SUBMODULE_FAILS
    \* Mapping from switches to WP thread identifiers
    SW_THREAD_SHARD_MAP <- const_SW_THREAD_SHARD_MAP
    \* Set of all OFC process identifiers
    OFCProcSet <- const_OFCProcSet
    \* Which switch modules (in a complex model) can fail
    SW_MODULE_CAN_FAIL_OR_NOT <- const_SW_MODULE_CAN_FAIL_OR_NOT

SPECIFICATION
    Spec

INVARIANT
    \* Respect DAG OP ordering
    ConsistencyReq
    \* For Nadir
    TypeOK

PROPERTY
    \* Must eventually converge
    InstallationLivenessProp

CHECK_DEADLOCK 
    FALSE
